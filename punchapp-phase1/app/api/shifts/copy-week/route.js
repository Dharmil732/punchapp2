import { serverAdmin } from '@/lib/serverAdmin'; export async function POST(req){ const {start}=await req.json(); const from=new Date(start); const to=new Date(from.getTime()+7*24*3600*1000); const sb=serverAdmin(); const {data}=await sb.from('shifts').select('*').gte('start_at',from.toISOString()).lt('start_at',to.toISOString()); const clones=(data||[]).map(s=>({...s,id:undefined,start_at:new Date(new Date(s.start_at).getTime()+7*24*3600*1000).toISOString(),end_at:new Date(new Date(s.end_at).getTime()+7*24*3600*1000).toISOString()})); if(clones.length) await sb.from('shifts').insert(clones); return Response.json({ok:true,clones:clones.length}); }

import { serverAdmin } from '@/lib/serverAdmin'; import { driveUpload } from '@/lib/google'; export async function POST(req){ const sb=serverAdmin(); const { name, contentBase64, start_date, end_date } = await req.json(); const up = await driveUpload(name, contentBase64); if(!up.ok) return Response.json({ ok:false, error: up.error||'Drive upload failed' }, { status: 500 }); await sb.rpc('log_export', { p_kind:'drive', p_start: start_date, p_end: end_date, p_location: up.file?.id||'drive' }); return Response.json({ ok:true, file: up.file }); }
